<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input type='button' value='Пуск!' onclick='start()'>
    <div style="display: inline-block;margin-left: 50px;"><span id="ig1"></span>:<span id="ig2"></span></div>
    <br /><br />
    <div style='width: 600px; height: 300px;border: solid yellow 1px; position: relative;background-color: yellow;'><div>
    <div id="ball" style="width: 50px ;height: 50px;border-radius: 50%;background-color: red;position: absolute;"></div>
    <div id="r1" style="background-color: red;width: 10px;height: 100px;position: absolute;"></div>
    <div id="r2" style="background-color: blue;width: 10px;height: 100px;position: absolute;"></div>
</div>
<script>
    let ball={
        posX:265,
        posY:125,
        speedX:3,
        speedY:3,
        width:50,
        height:50,
        igrok1:0,
        igrok2:0,
        update: function(){
            const player_1=document.getElementById("ig1");
            player_1.innerHTML=this.igrok1;
            const player_2=document.getElementById("ig2");
            player_2.innerHTML=this.igrok2;
            const ball=document.getElementById("ball");
            ball.style.left=this.posX + "px";
            ball.style.top=this.posY + "px";
            console.log("aaaa");
        }
    }
    let raketka1={
        width:10,
        height:100,
        speed:2,
        posX:0,
        posY:100,
        update: function(){
            const raket1=document.getElementById("r1");
            raket1.style.left=this.posX + "px";
            raket1.style.top=this.posY + "px";
        }
    }
    let raketka2={
        width:10,
        height:100,
        speed:2,
        posX:590,
        posY:100,
        update: function(){
            const raket2=document.getElementById("r2");
            raket2.style.left=this.posX + "px";
            raket2.style.top=this.posY + "px";
        }
    }
    let area={
        width:600,
        height:300
    }
    let p1Up=false;
    let p1Down=false;
    let p2Up=false;
    let p2Down=false;
    document.addEventListener("keydown",function(event){
        if(event.code === "ArrowDown"){
            p1Down=true;
        }
        if(event.code === "ArrowUp"){
            p1Up=true;
        }
        if(event.code === "ControlLeft"){
            p2Down=true;
        }if(event.code === "ShiftLeft"){
            p2Up=true;
        }
    })
    let GameIsActive=false;
    let interval = null;
    function randomNapr(){
        function getRandom(i) {
        return Math.floor(Math.random() * i);
        }
        chislo = getRandom(2);
        console.log(chislo);
        if(chislo === 1){
            ball.speedX= -ball.speedX
        }
    }
    document.addEventListener("keyup",function(event){
        if(event.code === "ArrowDown"){
            p2Down=false;
        }
        if(event.code === "ArrowUp"){
            p2Up=false;
        }
        if(event.code === "ControlLeft"){
            p1Down=false;
        }if(event.code === "ShiftLeft"){
            p1Up=false;
        }
    })
    
    function start(){
        if (GameIsActive) return;
        GameIsActive=true;
        ball.posX=0.5*area.width+0.5*ball.width;
        ball.posY=0.5*area.height+0.5*ball.height;
        ball.speedX=3;
        ball.speedY=3;
        randomNapr();
        if(interval) clearInterval(interval);
        interval = setInterval(tick,10);
    }
    function stop(){
        GameIsActive=false;
        ball.speedX=0;
        ball.speedY=0;
        if(interval){
            clearInterval(interval);
            GameIsActive=null;
        }
    }
    function tick(){
        if (!GameIsActive) return;
        ball.posX+=ball.speedX;
        if(ball.posX + ball.width>area.width){
            ball.posX=area.width-ball.width;
            ball.igrok1++;
            stop();
            ball.update();
            return;
        }
        if(ball.posX <= raketka1.posX + raketka1.width&&
            ball.posX +ball.width >= raketka1.posX&&
            ball.posY +ball.height >= raketka1.posY&&
            ball.posY <= raketka1.posY + raketka1.height||

            ball.posX <= raketka2.posX + raketka2.width&&
            ball.posX +ball.width >= raketka2.posX&&
            ball.posY +ball.height >= raketka2.posY&&
            ball.posY <= raketka2.posY + raketka2.height
        ){
            ball.speedX= -ball.speedX;
        }
        if(ball.posX<0){
            ball.posX=0;
            ball.igrok2++;
            stop();
            ball.update();
            return;
        }
        ball.posY+=ball.speedY;
        if(ball.posY + ball.height>area.height){
            ball.speedY= - ball.speedY;
            ball.posY=area.height -ball.height;
        }
        if(ball.posY<0){
            ball.speedY=-ball.speedY;
            ball.posY=0;
        }
        if(raketka1.posY<area.height - raketka1.height && p1Down){
            raketka1.posY+=raketka1.speed;
        }
        if(raketka1.posY>0 && p1Up){
            raketka1.posY-=raketka1.speed;
        }
        if(raketka2.posY<area.height - raketka2.height && p2Down){
            raketka2.posY+=raketka2.speed;
        }
        if(raketka2.posY>0 && p2Up){
            raketka2.posY-=raketka2.speed;
        }
        ball.update();
        raketka1.update();
        raketka2.update();
    }
    ball.update();
    raketka1.update();
    raketka2.update();
    
</script>
</body>
</html>